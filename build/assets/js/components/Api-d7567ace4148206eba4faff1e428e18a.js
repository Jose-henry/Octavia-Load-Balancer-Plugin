//# sourceMappingURL=Api.js.map
window.Octavia=window.Octavia||{};
(function(){const l=()=>{const e=document.querySelector('meta[name="csrf-token"]')||document.querySelector('meta[name="_csrf"]');return e?e.getAttribute("content"):null},m=()=>{const e=document.querySelector('meta[name="_csrf_header"]');return e?e.getAttribute("content"):"X-CSRF-TOKEN"},n=e=>(e=document.cookie.match(new RegExp("(^|; )"+e.replace(/([.*+?^${}()|[\]\\])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(e[2]):null,g=(e,d={})=>{const f={Accept:"application/json","X-Requested-With":"XMLHttpRequest"};
d.body&&(f["Content-Type"]="application/json");var a=l();if(a){const b=m();f[b]=a;f["X-CSRF-TOKEN"]=a}if(a=n("XSRF-TOKEN"))f["X-XSRF-TOKEN"]=a,f["X-CSRF-TOKEN"]||(f["X-CSRF-TOKEN"]=a);d=Object.assign({credentials:"include",headers:f},d);console.log(`[Octavia] Fetching: ${e}`,d);return fetch(e,d).then(async b=>{var c=await b.text();if(c)try{var h=JSON.parse(c)}catch(k){h={raw:c}}else h={};c=h;if(!b.ok)throw Error(c?.message||c?.error||`Request failed (${b.status})`);return c})};window.Octavia.makeApi=
e=>{const d=`/plugin/${e}`,f=(a,b)=>{const c=[];b&&b.networkId&&c.push("networkId="+b.networkId);b&&b.instanceId&&c.push("instanceId="+b.instanceId);return 0===c.length?a:a+(a.includes("?")?"&":"?")+c.join("&")};return{listLoadBalancers:a=>g(f(`${d}/loadbalancers`,a)),getLoadBalancer:(a,b)=>g(f(`${d}/loadbalancers/details?id=${a}`,b)),createLoadBalancer:a=>g(`${d}/loadbalancers/create`,{method:"POST",body:JSON.stringify(a)}),updateLoadBalancer:(a,b)=>g(`${d}/loadbalancers/update`,{method:"POST",body:JSON.stringify({...b,
id:a})}),deleteLoadBalancer:(a,b)=>g(`${d}/loadbalancers/delete`,{method:"POST",body:JSON.stringify({lbId:a,networkId:b})}),listOptions:(a,b)=>{const c={networkId:a,instanceId:b};return Promise.all(["projects","subnets","instances","floatingIpPools"].map(h=>g(f(`${d}/options/${h}`,c)))).then(h=>h.reduce((k,p)=>({...k,...p}),{}))},listListeners:(a,b)=>g(f(`${d}/loadbalancers/details?id=${a}`,b)).then(c=>({listeners:c.loadbalancer?.listeners||[]})),listPools:(a,b)=>g(f(`${d}/loadbalancers/details?id=${a}`,
b)).then(c=>({pools:c.loadbalancer?.pools||[]})),getHealthMonitor:(a,b)=>g(f(`${d}/loadbalancers/details?id=${a}`,b)).then(c=>{c=(c.loadbalancer?.pools||[]).find(h=>h.healthmonitor_id)?.healthmonitor_id;return{monitor:c?{id:c}:null}}),attachFloatingIp:(a,b,c)=>g(`${d}/floatingip/attach`,{method:"POST",body:JSON.stringify({lbId:a,floatingIpPoolId,networkId:c})}),detachFloatingIp:(a,b)=>g(`${d}/floatingip/detach`,{method:"POST",body:JSON.stringify({lbId:a,networkId:b})})}};window.Octavia.useAsync=(e,
d)=>{const [f,a]=React.useState({loading:!0});React.useEffect(()=>{let b=!0;a({loading:!0});e().then(c=>b&&a({loading:!1,data:c})).catch(c=>b&&a({loading:!1,error:c}));return()=>{b=!1}},d);return f}})();