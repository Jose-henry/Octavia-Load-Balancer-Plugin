//# sourceMappingURL=octavia-loadbalancer-ui.js.map
window.Octavia=window.Octavia||{};window.Octavia.Badge=({text:a,tone:d="info"})=>React.createElement("span",{className:`label label-${d}`,style:{marginRight:6,borderRadius:3,padding:"3px 8px",fontSize:"0.8em"}},a);
window.Octavia.Field=({label:a,children:d,help:g,required:h})=>React.createElement("div",{className:"form-group"},React.createElement("label",{className:"control-label"},a,h?React.createElement("span",{className:"text-danger"}," *"):null),d,g?React.createElement("div",{className:"help-block"},g):null);
window.Octavia.Toast=({msg:a,type:d,onClose:g})=>{React.useEffect(()=>{const h=setTimeout(g,3E3);return()=>clearTimeout(h)},[g]);return React.createElement("div",{style:{position:"fixed",top:20,right:20,zIndex:9999,backgroundColor:"error"===d?"#f2dede":"#dff0d8",color:"error"===d?"#a94442":"#3c763d",padding:"10px 20px",borderRadius:4,boxShadow:"0 2px 10px rgba(0,0,0,0.2)",display:"flex",alignItems:"center"}},React.createElement("span",{style:{marginRight:10}},a),React.createElement("button",{onClick:g,
style:{background:"none",border:"none",fontSize:16,cursor:"pointer",color:"inherit"}},"&times;"))};window.Octavia=window.Octavia||{};
(function(){const a=()=>{const e=document.querySelector('meta[name="csrf-token"]')||document.querySelector('meta[name="_csrf"]');return e?e.getAttribute("content"):null},d=()=>{const e=document.querySelector('meta[name="_csrf_header"]');return e?e.getAttribute("content"):"X-CSRF-TOKEN"},g=e=>(e=document.cookie.match(new RegExp("(^|; )"+e.replace(/([.*+?^${}()|[\]\\])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(e[2]):null,h=(e,b={})=>{const p={Accept:"application/json","X-Requested-With":"XMLHttpRequest"};
b.body&&(p["Content-Type"]="application/json");var c=a();if(c){const l=d();p[l]=c;p["X-CSRF-TOKEN"]=c}if(c=g("XSRF-TOKEN"))p["X-XSRF-TOKEN"]=c,p["X-CSRF-TOKEN"]||(p["X-CSRF-TOKEN"]=c);b=Object.assign({credentials:"include",headers:p},b);console.log(`[Octavia] Fetching: ${e}`,b);return fetch(e,b).then(async l=>{var f=await l.text();if(f)try{var t=JSON.parse(f)}catch(w){t={raw:f}}else t={};f=t;if(!l.ok)throw Error(f?.message||f?.error||`Request failed (${l.status})`);return f})};window.Octavia.makeApi=
e=>{const b=`/plugin/${e}`;console.log(`[Octavia API] Initialized with Base URL: ${b}`);const p=(c,l)=>{const f=[];l&&l.networkId&&f.push("networkId="+l.networkId);l&&l.instanceId&&f.push("instanceId="+l.instanceId);return 0===f.length?c:c+(c.includes("?")?"&":"?")+f.join("&")};return{getSubnets:c=>c?h(`${b}/optionSubnets?networkId=${c}`,{method:"GET"}):Promise.resolve({data:[]}),listLoadBalancers:c=>h(p(`${b}/loadbalancers`,c)),getLoadBalancer:(c,l)=>h(p(`${b}/loadbalancerDetails?id=${c}`,l)),createLoadBalancer:c=>
h(`${b}/loadbalancersCreate`,{method:"POST",body:JSON.stringify(c)}),updateLoadBalancer:(c,l)=>h(`${b}/loadbalancerUpdate`,{method:"POST",body:JSON.stringify({...l,id:c})}),deleteLoadBalancer:(c,l)=>h(`${b}/loadbalancersDelete`,{method:"POST",body:JSON.stringify({lbId:c,networkId:l})}),listOptions:(c,l)=>{c={networkId:c,instanceId:l};return Promise.all([h(p(`${b}/optionProjects`,c)).then(f=>({optionProjects:f.data||[],optionResourcePools:f.resourcePools||[]})),h(p(`${b}/optionSubnets`,c)).then(f=>
({optionSubnets:f.data||[]})),h(p(`${b}/optionInstances`,c)).then(f=>({optionInstances:f.data||[]})),h(p(`${b}/optionFloatingIpPools`,c)).then(f=>({optionFloatingIpPools:f.data||[]}))]).then(f=>f.reduce((t,w)=>({...t,...w}),{}))},listListeners:(c,l)=>h(p(`${b}/loadbalancerDetails?id=${c}`,l)).then(f=>({listeners:f.loadbalancer?.listeners||[]})),listPools:(c,l)=>h(p(`${b}/loadbalancerDetails?id=${c}`,l)).then(f=>({pools:f.loadbalancer?.pools||[]})),getHealthMonitor:(c,l)=>h(p(`${b}/loadbalancerDetails?id=${c}`,
l)).then(f=>{f=(f.loadbalancer?.pools||[]).find(t=>t.healthmonitor_id)?.healthmonitor_id;return{monitor:f?{id:f}:null}}),attachFloatingIp:(c,l,f)=>h(`${b}/floatingipAttach`,{method:"POST",body:JSON.stringify({lbId:c,floatingIpPoolId:l,networkId:f})}),detachFloatingIp:(c,l)=>h(`${b}/floatingipDetach`,{method:"POST",body:JSON.stringify({lbId:c,networkId:l})}),pollStatus:(c,l,f=3E3,t=40)=>new Promise((w,r)=>{let n=0;const u=()=>{n++;h(p(`${b}/loadbalancerDetails?id=${c}`,l)).then(x=>{x=x.data||x.loadbalancer||
x;const m=x.provisioning_status;"ACTIVE"===m||"ERROR"===m||"DELETED"===m?w(x):n>=t?r(Error("Status polling timed out")):setTimeout(u,f)}).catch(x=>{n>=t?r(x):setTimeout(u,f)})};u()})}};window.Octavia.useAsync=(e,b)=>{const [p,c]=React.useState({loading:!0});React.useEffect(()=>{let l=!0;c({loading:!0});e().then(f=>l&&c({loading:!1,data:f})).catch(f=>l&&c({loading:!1,error:f}));return()=>{l=!1}},b);return p}})();
(function(){window.Octavia=window.Octavia||{};window.Octavia.Steps={Step1_Details:({data:a,update:d,options:g})=>{const {Field:h}=window.Octavia,e=g?.optionResourcePools?.[0]?.name||"None";return React.createElement("div",{className:"form-horizontal"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(h,{label:"Project (Tenant)"},React.createElement("input",{className:"form-control",value:g?.optionProjects?.[0]?.name||"None",readOnly:!0,
disabled:!0}))),React.createElement("div",{className:"col-md-6"},React.createElement(h,{label:"Resource Pool"},React.createElement("input",{className:"form-control",value:e,readOnly:!0,disabled:!0})))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(h,{label:"Name",required:!0},React.createElement("input",{className:"form-control",value:a.name||"",onChange:b=>d("name",b.target.value),placeholder:"My Load Balancer"}))),React.createElement("div",
{className:"col-md-6"},React.createElement(h,{label:"Description"},React.createElement("input",{className:"form-control",value:a.description||"",onChange:b=>d("description",b.target.value),placeholder:"Optional description"})))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(h,{label:"VIP Subnet",required:!0},React.createElement("select",{className:"form-control",value:a.vipSubnetId||"",onChange:b=>d("vipSubnetId",b.target.value)},
React.createElement("option",{value:!0},"Select Subnet..."),(g.subnets||[]).map(b=>React.createElement("option",{key:b.value,value:b.value},b.name,b.cidr?`(${b.cidr})`:""))))),React.createElement("div",{className:"col-md-6"},React.createElement(h,{label:"IP Address"},React.createElement("input",{className:"form-control",value:a.vipAddress||"",onChange:b=>d("vipAddress",b.target.value),placeholder:"Auto-assign"})))))},Step2_Listener:({data:a,update:d})=>{const {Field:g}=window.Octavia,h="HTTP HTTPS TERMINATED_HTTPS TCP UDP SCTP".split(" "),
e=["HTTP","TERMINATED_HTTPS"].includes(a.listenerProtocol),b="TERMINATED_HTTPS"===a.listenerProtocol,p=["UDP","SCTP"].includes(a.listenerProtocol);return React.createElement("div",{className:"form-horizontal"},React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.createListener,onChange:c=>d("createListener",c.target.checked)}),
React.createElement("strong",null,"Create Listener"))))),a.createListener&&React.createElement("div",{style:{borderLeft:"3px solid #ddd",paddingLeft:15,marginLeft:5}},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Listener Name",required:!0},React.createElement("input",{className:"form-control",value:a.listenerName||"",onChange:c=>d("listenerName",c.target.value)}))),React.createElement("div",{className:"col-md-3"},React.createElement(g,
{label:"Protocol",required:!0},React.createElement("select",{className:"form-control",value:a.listenerProtocol||"HTTP",onChange:c=>d("listenerProtocol",c.target.value)},h.map(c=>React.createElement("option",{key:c,value:c},c))))),React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"Port",required:!0},React.createElement("input",{type:"number",className:"form-control",value:a.listenerPort||80,onChange:c=>d("listenerPort",parseInt(c.target.value)),min:"1",max:"65535"})))),
React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Connection Limit"},React.createElement("input",{type:"number",className:"form-control",value:a.connectionLimit||-1,onChange:c=>d("connectionLimit",parseInt(c.target.value)),placeholder:"-1 for infinite"}))),React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Allowed CIDRs"},React.createElement("input",{className:"form-control",value:a.allowedCidrs||
"",onChange:c=>d("allowedCidrs",c.target.value),placeholder:"e.g. 192.168.1.0/24, 10.0.0.0/8"})))),!p&&React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"Client Data Timeout"},React.createElement("input",{type:"number",className:"form-control",value:a.clientDataTimeout||5E4,onChange:c=>d("clientDataTimeout",parseInt(c.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"TCP Inspect Timeout"},
React.createElement("input",{type:"number",className:"form-control",value:a.tcpInspectTimeout||0,onChange:c=>d("tcpInspectTimeout",parseInt(c.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"Member Connect Timeout"},React.createElement("input",{type:"number",className:"form-control",value:a.memberConnectTimeout||5E3,onChange:c=>d("memberConnectTimeout",parseInt(c.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(g,
{label:"Member Data Timeout"},React.createElement("input",{type:"number",className:"form-control",value:a.memberDataTimeout||5E4,onChange:c=>d("memberDataTimeout",parseInt(c.target.value))})))),e&&React.createElement("div",{className:"well ml-3"},React.createElement("label",null,"Insert Headers"),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.insertXForwardedFor||!1,onChange:c=>d("insertXForwardedFor",c.target.checked)}),
" X-Forwarded-For")),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.insertXForwardedPort||!1,onChange:c=>d("insertXForwardedPort",c.target.checked)})," X-Forwarded-Port")),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.insertXForwardedProto||!1,onChange:c=>d("insertXForwardedProto",c.target.checked)})," X-Forwarded-Proto"))),
b&&React.createElement("div",{className:"well ml-3"},React.createElement("label",null,"TLS Configuration"),React.createElement(g,{label:"TLS Cipher String"},React.createElement("input",{className:"form-control",value:a.tlsCipherString||"",onChange:c=>d("tlsCipherString",c.target.value),placeholder:"Default"})))))},Step3_Pool:({data:a,update:d})=>{const {Field:g}=window.Octavia,h=["ROUND_ROBIN","LEAST_CONNECTIONS","SOURCE_IP"],e=["HTTP","HTTPS","TCP","UDP","SCTP"];return React.createElement("div",
{className:"form-horizontal"},React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.createPool,onChange:b=>d("createPool",b.target.checked)}),React.createElement("strong",null,"Create Pool"))))),a.createPool&&React.createElement("div",{style:{borderLeft:"3px solid #ddd",paddingLeft:15,marginLeft:5}},React.createElement("div",
{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Pool Name",required:!0},React.createElement("input",{className:"form-control",value:a.poolName||"",onChange:b=>d("poolName",b.target.value)}))),React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Algorithm",required:!0},React.createElement("select",{className:"form-control",value:a.poolAlgorithm||"ROUND_ROBIN",onChange:b=>d("poolAlgorithm",b.target.value)},h.map(b=>React.createElement("option",
{key:b,value:b},b)))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Protocol",required:!0},React.createElement("select",{className:"form-control",value:a.poolProtocol||a.listenerProtocol||"HTTP",onChange:b=>d("poolProtocol",b.target.value)},e.map(b=>React.createElement("option",{key:b,value:b},b))))),React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Description"},React.createElement("input",
{className:"form-control",value:a.poolDesc||"",onChange:b=>d("poolDesc",b.target.value)})))),React.createElement("div",{className:"well"},React.createElement("label",null,"Session Persistence"),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Type"},React.createElement("select",{className:"form-control",value:a.sessionPersistence||"None",onChange:b=>d("sessionPersistence",b.target.value)},React.createElement("option",{value:"None"},
"None"),React.createElement("option",{value:"SOURCE_IP"},"Source IP"),React.createElement("option",{value:"HTTP_COOKIE"},"HTTP Cookie"),React.createElement("option",{value:"APP_COOKIE"},"App Cookie")))),"APP_COOKIE"===a.sessionPersistence&&React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Cookie Name",required:!0},React.createElement("input",{className:"form-control",value:a.cookieName||"",onChange:b=>d("cookieName",b.target.value)}))))),React.createElement("div",{className:"well"},
React.createElement("label",null,"TLS Encryption (Backend Re-encryption)"),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.poolTlsEnabled||!1,onChange:b=>d("poolTlsEnabled",b.target.checked)}),"Enable TLS")),a.poolTlsEnabled&&React.createElement(g,{label:"Cipher String"},React.createElement("input",{className:"form-control",value:a.poolTlsCipher||"",onChange:b=>d("poolTlsCipher",b.target.value),placeholder:"Default"})))))},
Step4_Members:({data:a,update:d,options:g})=>{const {Badge:h}=window.Octavia,[e,b]=React.useState(""),p=(g.instances||[]).filter(m=>!(a.members||[]).find(y=>y.id===m.value)),[c,l]=React.useState(""),[f,t]=React.useState(80),[w,r]=React.useState(1),n=()=>{if(e){var m=g.instances.find(y=>y.value===e);m={id:m.value,name:m.name,type:"INTERNAL",address:"10.0.0."+Math.floor(255*Math.random()),port:80,weight:1,role:"member"};d("members",[...(a.members||[]),m]);b("")}},u=()=>{if(c){var m={id:"ext-"+Math.floor(1E4*
Math.random()),name:c,type:"EXTERNAL",address:c,port:f,weight:w,role:"member"};d("members",[...(a.members||[]),m]);l("")}},x=m=>{d("members",(a.members||[]).filter(y=>y.id!==m))};return React.createElement("div",null,a.createPool?React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},"Add Instance Member"),React.createElement("div",
{className:"panel-body"},React.createElement("div",{className:"input-group"},React.createElement("select",{className:"form-control",value:e,onChange:m=>b(m.target.value)},React.createElement("option",{value:!0},"Select Instance..."),p.map(m=>React.createElement("option",{key:m.value,value:m.value},m.name))),React.createElement("span",{className:"input-group-btn"},React.createElement("button",{className:"btn btn-success",onClick:n,disabled:!e},"Add")))))),React.createElement("div",{className:"col-md-6"},
React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},"Add External Member"),React.createElement("div",{className:"panel-body"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-5"},React.createElement("input",{className:"form-control input-sm",placeholder:"IP Address",value:c,onChange:m=>l(m.target.value)})),React.createElement("div",{className:"col-xs-3"},React.createElement("input",{type:"number",
className:"form-control input-sm",placeholder:"Port",value:f,onChange:m=>t(parseInt(m.target.value))})),React.createElement("div",{className:"col-xs-2"},React.createElement("input",{type:"number",className:"form-control input-sm",placeholder:"Wgt",value:w,onChange:m=>r(parseInt(m.target.value))})),React.createElement("div",{className:"col-xs-2"},React.createElement("button",{className:"btn btn-success btn-sm btn-block",onClick:u,disabled:!c},"Add"))))))),React.createElement("table",{className:"table table-striped table-bordered"},
React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Name"),React.createElement("th",null,"Address"),React.createElement("th",null,"Port"),React.createElement("th",null,"Weight"),React.createElement("th",null,"Type"),React.createElement("th",null))),React.createElement("tbody",null,0===(a.members||[]).length?React.createElement("tr",null,React.createElement("td",{colSpan:"6",className:"text-center text-muted"},"No members defined")):(a.members||[]).map(m=>
React.createElement("tr",{key:m.id},React.createElement("td",null,m.name),React.createElement("td",null,m.address),React.createElement("td",null,m.port),React.createElement("td",null,m.weight),React.createElement("td",null,React.createElement(h,{text:m.type||"INTERNAL",tone:"EXTERNAL"===m.type?"warning":"info"})),React.createElement("td",{className:"text-right"},React.createElement("button",{className:"btn btn-xs",style:{backgroundColor:"#b00020",color:"#fff",border:"none",padding:"3px 8px"},onClick:()=>
x(m.id)},React.createElement("i",{className:"fa fa-trash"})))))))):React.createElement("div",{className:"alert alert-warning"},"Pool creation is disabled. No members can be added."))},Step5_Monitor:({data:a,update:d})=>{const {Field:g}=window.Octavia,h="HTTP HTTPS PING TCP TLS-HELLO UDP-CONNECT SCTP".split(" ");return React.createElement("div",{className:"form-horizontal"},React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",
{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.createMonitor,onChange:e=>d("createMonitor",e.target.checked)}),React.createElement("strong",null,"Create Health Monitor"))))),a.createMonitor&&React.createElement("div",{style:{borderLeft:"3px solid #ddd",paddingLeft:15,marginLeft:5}},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Name",required:!0},React.createElement("input",
{className:"form-control",value:a.monitorName||"",onChange:e=>d("monitorName",e.target.value)}))),React.createElement("div",{className:"col-md-6"},React.createElement(g,{label:"Type",required:!0},React.createElement("select",{className:"form-control",value:a.monitorType||"HTTP",onChange:e=>d("monitorType",e.target.value)},h.map(e=>React.createElement("option",{key:e,value:e},e)))))),("HTTP"===a.monitorType||"HTTPS"===a.monitorType)&&React.createElement("div",null,React.createElement("div",{className:"row"},
React.createElement("div",{className:"col-md-4"},React.createElement(g,{label:"HTTP Method"},React.createElement("select",{className:"form-control",value:a.httpMethod||"GET",onChange:e=>d("httpMethod",e.target.value)},"GET HEAD POST PUT DELETE TRACE OPTIONS PATCH CONNECT".split(" ").map(e=>React.createElement("option",{key:e,value:e},e))))),React.createElement("div",{className:"col-md-4"},React.createElement(g,{label:"Expected Codes"},React.createElement("input",{className:"form-control",value:a.expectedCodes||
"200",onChange:e=>d("expectedCodes",e.target.value),placeholder:"200, 200-204"}))),React.createElement("div",{className:"col-md-4"},React.createElement(g,{label:"URL Path"},React.createElement("input",{className:"form-control",value:a.urlPath||"/",onChange:e=>d("urlPath",e.target.value),placeholder:"/"}))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"Delay (sec)",required:!0},React.createElement("input",{type:"number",
className:"form-control",value:a.delay||5,onChange:e=>d("delay",parseInt(e.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"Timeout (sec)",required:!0},React.createElement("input",{type:"number",className:"form-control",value:a.timeout||5,onChange:e=>d("timeout",parseInt(e.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"Max Retries",required:!0},React.createElement("input",{type:"number",className:"form-control",
value:a.maxRetries||3,onChange:e=>d("maxRetries",parseInt(e.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(g,{label:"Max Retries Down"},React.createElement("input",{type:"number",className:"form-control",value:a.maxRetriesDown||3,onChange:e=>d("maxRetriesDown",parseInt(e.target.value))}))))))}}})();
const DeleteConfirmModal=({lb:a,onClose:d,onConfirm:g,loading:h})=>React.createElement("div",{className:"modal fade in",style:{display:"block"}},React.createElement("div",{className:"modal-dialog"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("button",{type:"button",className:"close",onClick:d,"data-dismiss":"modal","aria-label":"Close"},React.createElement("span",{"aria-hidden":"true"},React.createElement("svg",{version:"1.1",
className:"close-icon",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 59.9 59.9",enableBackground:"new 0 0 59.9 59.9",xmlSpace:"preserve"},React.createElement("line",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",x1:"57.4",y1:"2.5",x2:"2.5",y2:"57.4"}),React.createElement("line",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",x1:"2.5",y1:"2.5",x2:"57.4",y2:"57.4"})))),React.createElement("h4",{className:"modal-title"},"Delete Load Balancer")),
React.createElement("div",{className:"modal-body"},React.createElement("p",null,"Are you sure you want to delete",React.createElement("strong",null,a.name),"?"),React.createElement("p",{className:"text-muted"},React.createElement("small",null,"This action cannot be undone.")),h&&React.createElement("div",{className:"text-center"},React.createElement("i",{className:"fa fa-spinner fa-spin"})," Deleting...")),React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"btn btn-link",
onClick:d,disabled:h},"Cancel"),React.createElement("button",{className:"btn btn-danger",onClick:g,disabled:h},"Delete")))),React.createElement("div",{className:"modal-backdrop fade in"}));window.Octavia=window.Octavia||{};window.Octavia.DeleteConfirmModal=DeleteConfirmModal;
(function(){window.Octavia.CreateWizard=({networkId:a,options:d,onCreated:g,onClose:h})=>{const {Step1_Details:e,Step2_Listener:b,Step3_Pool:p,Step4_Members:c,Step5_Monitor:l}=window.Octavia.Steps,[f,t]=React.useState(1),[w,r]=React.useState(""),[n,u]=React.useState({networkId:a,createListener:!0,createPool:!0,createMonitor:!0,listenerProtocol:"HTTP",listenerPort:80,poolProtocol:"HTTP",poolAlgorithm:"ROUND_ROBIN",monitorType:"HTTP",members:[]}),[x,m]=React.useState(!1),y=(k,q)=>u(v=>({...v,[k]:q}));
React.useEffect(()=>{d&&d.subnets&&0<d.subnets.length&&!n.vipSubnetId&&y("vipSubnetId",d.subnets[0].value)},[d]);const B=k=>{if(1===k){if(!n.name||!n.name.trim())return"Name is required.";if(!n.vipSubnetId)return"VIP Subnet is required."}if(2===k&&n.createListener){if(!n.listenerName||!n.listenerName.trim())return"Listener Name is required.";if(!n.listenerProtocol)return"Listener Protocol is required.";if(!n.listenerPort)return"Listener Port is required."}if(3===k&&n.createPool){if(!n.poolName||!n.poolName.trim())return"Pool Name is required.";
if(!("APP_COOKIE"!==n.sessionPersistence||n.cookieName&&n.cookieName.trim()))return"Cookie Name is required."}if(5===k&&n.createMonitor){if(!n.monitorName||!n.monitorName.trim())return"Monitor Name is required.";if(!n.monitorType)return"Monitor Type is required.";if(!n.delay)return"Delay is required.";if(!n.timeout)return"Timeout is required.";if(!n.maxRetries)return"Max Retries is required."}return null};a=()=>{const k=B(f);k?r(k):(r(""),t(f+1))};const z=()=>{r("");t(f-1)},A=k=>{if(k>f){const q=
B(f);if(q){r(q);return}}r("");t(k)},C=()=>{const k=B(5);k?r(k):(r(""),m(!0),window.Octavia.api.createLoadBalancer(n).then(()=>{m(!1);g()}).catch(q=>{m(!1);r("Error: "+q.message)}))};return React.createElement("div",{className:"modal fade in",style:{display:"block",backgroundColor:"rgba(0,0,0,0.5)",overflowY:"auto"}},React.createElement("div",{className:"modal-dialog modal-lg"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("button",
{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:h},React.createElement("span",{"aria-hidden":"true"},React.createElement("svg",{version:"1.1",className:"close-icon",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 59.9 59.9",enableBackground:"new 0 0 59.9 59.9",xmlSpace:"preserve"},React.createElement("line",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",x1:"57.4",y1:"2.5",x2:"2.5",y2:"57.4"}),
React.createElement("line",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",x1:"2.5",y1:"2.5",x2:"57.4",y2:"57.4"})))),React.createElement("h4",{className:"modal-title"},"Create Load Balancer")),React.createElement("div",{className:"modal-body"},w&&React.createElement("div",{className:"alert alert-danger",style:{padding:"10px 15px",marginBottom:20}},w),React.createElement("div",{className:"wizard",style:{marginBottom:20}},React.createElement("ul",{className:"breadcrumbs"},React.createElement("li",
{className:`bc ${1===f?"active":1<f?"prevActive":""}`,onClick:()=>A(1),style:{cursor:"pointer"}},"Details"),React.createElement("li",{className:`bc ${2===f?"active":2<f?"prevActive":""}`,onClick:()=>A(2),style:{cursor:"pointer"}},"Listener"),React.createElement("li",{className:`bc ${3===f?"active":3<f?"prevActive":""}`,onClick:()=>A(3),style:{cursor:"pointer"}},"Pool"),React.createElement("li",{className:`bc ${4===f?"active":4<f?"prevActive":""}`,onClick:()=>A(4),style:{cursor:"pointer"}},"Members"),
React.createElement("li",{className:`bc ${5===f?"active":5<f?"prevActive":""}`,onClick:()=>A(5),style:{cursor:"pointer"}},"Monitor"))),(()=>{switch(f){case 1:return React.createElement(e,{data:n,update:y,options:d});case 2:return React.createElement(b,{data:n,update:y});case 3:return React.createElement(p,{data:n,update:y});case 4:return React.createElement(c,{data:n,update:y,options:d});case 5:return React.createElement(l,{data:n,update:y});default:return React.createElement("div",null,"Unknown Step")}})()),
React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"btn btn-default",onClick:h},"Cancel"),1<f&&React.createElement("button",{className:"btn btn-default",onClick:z},"Previous"),5>f&&React.createElement("button",{className:"btn btn-primary",onClick:a},"Next"),5===f&&React.createElement("button",{className:"btn btn-success",onClick:C,disabled:x},x?"Creating...":"Create Load Balancer")))))}})();
(function(){window.Octavia.EditLBModal=({lb:a,networkId:d,options:g,onClose:h,onUpdated:e})=>{const b=window.Octavia.api,{Field:p,useAsync:c}=window.Octavia,{Step2_Listener:l,Step3_Pool:f,Step4_Members:t,Step5_Monitor:w}=window.Octavia.Steps,[r,n]=React.useState("general"),[u,x]=React.useState({...a}),[m,y]=React.useState(!1),{loading:B,data:z}=c(async()=>{const [k,q,v]=await Promise.all([b.listListeners(a.id,{networkId:d}),b.listPools(a.id,{networkId:d}),b.getHealthMonitor(a.id,{networkId:d})]);
return{...k,...q,...v}},[a.id]);React.useEffect(()=>{if(z){const q={...u};if(z.listeners&&0<z.listeners.length){var k=z.listeners[0];q.createListener=!0;q.listenerName=k.name;q.listenerProtocol=k.protocol;q.listenerPort=k.protocol_port;q.connectionLimit=k.connection_limit;q.allowedCidrs=(k.allowed_cidrs||[]).join(",")}else q.createListener=!1;z.pools&&0<z.pools.length?(k=z.pools[0],q.createPool=!0,q.poolName=k.name,q.poolAlgorithm=k.lb_algorithm,q.poolProtocol=k.protocol,q.poolDesc=k.description,
q.members=k.members||[]):q.createPool=!1;z.monitor?(k=z.monitor,q.createMonitor=!0,q.monitorName=k.name||"Monitor",q.monitorType=k.type,q.delay=k.delay,q.timeout=k.timeout,q.maxRetries=k.max_retries):q.createMonitor=!1;x(q)}},[z]);const A=(k,q)=>x(v=>({...v,[k]:q})),C=[{key:"general",title:"General"},{key:"listener",title:"Listener"},{key:"pool",title:"Pool"},{key:"monitor",title:"Health Monitor"}];return React.createElement("div",{className:"modal fade in",style:{display:"block",backgroundColor:"rgba(0,0,0,0.5)",
overflowY:"auto"}},React.createElement("div",{className:"modal-dialog modal-lg"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("button",{type:"button",className:"close",onClick:h,"aria-label":"Close","data-dismiss":"modal"},React.createElement("span",{"aria-hidden":"true"},React.createElement("svg",{version:"1.1",className:"close-icon",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",
y:"0px",viewBox:"0 0 59.9 59.9",enableBackground:"new 0 0 59.9 59.9",xmlSpace:"preserve"},React.createElement("line",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",x1:"57.4",y1:"2.5",x2:"2.5",y2:"57.4"}),React.createElement("line",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",x1:"2.5",y1:"2.5",x2:"57.4",y2:"57.4"})))),React.createElement("h4",{className:"modal-title"},"Edit Load Balancer")),React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"wizard",
style:{marginBottom:20}},React.createElement("ul",{className:"breadcrumbs"},C.map((k,q)=>{const v=C.findIndex(D=>D.key===r);return React.createElement("li",{key:k.key,className:`bc ${r===k.key?"active":q<v?"prevActive":""}`,onClick:()=>n(k.key),style:{cursor:"pointer"}},k.title)}))),React.createElement("div",{className:"tab-content",style:{padding:"10px 0"}},B?React.createElement("div",{style:{textAlign:"center",padding:40}},React.createElement("i",{className:"fa fa-spinner fa-spin"})," Loading..."):
React.createElement("div",null,"general"===r&&React.createElement("div",{className:"form-horizontal"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(p,{label:"Project (Tenant)"},React.createElement("input",{className:"form-control",value:g?.optionProjects?.[0]?.name||"None",readOnly:!0,disabled:!0}))),React.createElement("div",{className:"col-md-6"},React.createElement(p,{label:"Resource Pool"},React.createElement("input",{className:"form-control",
value:g?.optionResourcePools?.[0]?.name||"None",readOnly:!0,disabled:!0})))),React.createElement(p,{label:"Name"},React.createElement("input",{className:"form-control",value:u.name||"",onChange:k=>A("name",k.target.value)})),React.createElement(p,{label:"Description"},React.createElement("input",{className:"form-control",value:u.description||"",onChange:k=>A("description",k.target.value)})),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",
{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:u.admin_state_up,onChange:k=>A("admin_state_up",k.target.checked)})," Admin State Up"))))),"listener"===r&&React.createElement(l,{data:u,update:A}),"pool"===r&&React.createElement("div",null,React.createElement(f,{data:u,update:A}),React.createElement("hr",null),React.createElement("h5",{style:{fontWeight:600,marginBottom:15}},"Members"),React.createElement(t,{data:u,update:A,options:{instances:[]}})),
"monitor"===r&&React.createElement(w,{data:u,update:A})))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"btn btn-default",onClick:h},"Cancel"),React.createElement("button",{className:"btn btn-success",onClick:()=>{y(!0);b.updateLoadBalancer(a.id,u).then(e).catch(k=>{y(!1);alert(k.message)})},disabled:m||B},m?"Saving...":"Save Changes")))))}})();
(function(){window.Octavia.NetworkView=({networkId:a})=>{const d=window.Octavia.api,{Badge:g,useAsync:h,Toast:e}=window.Octavia,[b,p]=React.useState("list"),[c,l]=React.useState(null),[f,t]=React.useState(null);var w=h(()=>d.listOptions(a),[a]),r=h(()=>d.listLoadBalancers({networkId:a}),[a,f]);const [n,u]=React.useState(null),[x,m]=React.useState(!1),[y,B]=React.useState([]),z="create"===b;React.useEffect(()=>{z&&d.getSubnets(a).then(v=>{v=(v?.data||[]).map(D=>({name:D.name,value:D.value,cidr:D.cidr}));
B(v)}).catch(v=>console.error("Error fetching subnets:",v))},[z,a]);if(r.error)return React.createElement("div",{className:"alert alert-danger"},r.error.message);if(r.loading||w.loading)return React.createElement("div",{style:{padding:20}},React.createElement("i",{className:"fa fa-spinner fa-spin"})," Loading...");r=r.data.loadbalancers||[];w=w.data||{};const A=()=>{m(!0);d.deleteLoadBalancer(n.id,a).then(()=>{m(!1);u(null);t({msg:"Load Balancer deleted successfully.",type:"success"})})},C=window.Octavia.CreateWizard,
k=window.Octavia.EditLBModal,q=window.Octavia.DeleteConfirmModal;return React.createElement("div",null,f&&React.createElement(e,{msg:f.msg,type:f.type,onClose:()=>t(null)}),n&&React.createElement(q,{lb:n,loading:x,onClose:()=>u(null),onConfirm:A}),"create"===b&&React.createElement(C,{networkId:a,options:{...w,subnets:y},onClose:()=>p("list"),onCreated:()=>{p("list");t({msg:"Load Balancer created.",type:"success"})}}),"edit"===b&&c&&React.createElement(k,{lb:c,networkId:a,options:{...w,subnets:y},
onClose:()=>{l(null);p("list")},onUpdated:()=>{l(null);p("list");t({msg:"Load Balancer updated.",type:"success"})}}),"list"===b&&React.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"15px"}},React.createElement("button",{className:"btn btn-primary",onClick:()=>p("create")},"+ ADD")),"list"===b&&React.createElement("table",{className:"table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"NAME"),React.createElement("th",
null,"VIP"),React.createElement("th",null,"STATUS"),React.createElement("th",null,"MEMBERS"))),React.createElement("tbody",null,r.map(v=>React.createElement("tr",{key:v.id},React.createElement("td",null,v.name),React.createElement("td",null,v.vip_address),React.createElement("td",null,React.createElement(g,{text:v.provisioning_status,tone:"ACTIVE"===v.provisioning_status?"success":"warning"})),React.createElement("td",null,(v.members||[]).length))),0===r.length&&React.createElement("tr",null,React.createElement("td",
{colSpan:"4",className:"text-center text-muted",style:{padding:"40px 0"}},'No Load Balancers found. Click "+ ADD" to create one.')))))}})();
(function(){window.Octavia.InstanceView=({instanceId:a})=>{const d=window.Octavia.api,{Badge:g,useAsync:h}=window.Octavia;var e=h(()=>d.listLoadBalancers({instanceId:a}),[a]);if(e.error)return React.createElement("div",{className:"alert alert-danger"},e.error.message);if(e.loading)return React.createElement("div",{style:{padding:20,textAlign:"center"}},React.createElement("span",{style:{display:"inline-block",width:16,height:16,border:"2px solid #ccc",borderTopColor:"#333",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),
" Loading...");e=e.data?.loadbalancers||[];return 0===e.length?React.createElement("div",{className:"alert alert-info"},"This instance is not a member of any Load Balancers."):React.createElement("div",{className:"container-fluid",style:{padding:"0 12px"}},React.createElement("h4",{style:{textTransform:"uppercase",fontWeight:600,letterSpacing:"0.5px",color:"#2d6ca2",marginBottom:15}},"Load balancers associated with this instance"),React.createElement("p",{className:"text-muted",style:{marginBottom:15,
fontSize:"0.9em"}},"This instance is a pool member of the following load balancers. Click a name to manage it on the Network detail page."),React.createElement("div",{className:"table-responsive"},React.createElement("table",{className:"table table-striped table-hover"},React.createElement("thead",null,React.createElement("tr",{style:{textTransform:"uppercase",fontSize:"0.85em",fontWeight:600}},React.createElement("th",null,"Name"),React.createElement("th",null,"VIP"),React.createElement("th",null,
"Status"),React.createElement("th",null,"Members"),React.createElement("th",null,"Network"))),React.createElement("tbody",null,e.map(b=>React.createElement("tr",{key:b.id},React.createElement("td",null,React.createElement("a",{href:"/infrastructure/networks/"+(b.networkId||"")+"#!octavia-network-tab",style:{fontWeight:"bold",color:"#2d6ca2",textDecoration:"none"},title:"View in Network detail Octavia tab"},b.name)),React.createElement("td",null,b.vip_address),React.createElement("td",null,React.createElement(g,
{text:b.provisioning_status||"ACTIVE",tone:"ACTIVE"===(b.provisioning_status||"ACTIVE")?"success":"warning"})),React.createElement("td",null,(b.members||[]).length),React.createElement("td",null,React.createElement("a",{href:"/infrastructure/networks/"+(b.networkId||""),style:{color:"#2d6ca2"}},b.networkName||"View Network"))))))))}})();window.Octavia=window.Octavia||{};console.log("Octavia UI Components Loaded.");
const mountNode=document.getElementById("octavia-loadbalancer-view"),pluginCode=mountNode?.dataset?.pluginCode||"octavia1234";window.Octavia.api=window.Octavia.makeApi(pluginCode);
const {NetworkView,InstanceView}=window.Octavia,App=()=>{var a=document.getElementById("octavia-loadbalancer-view"),d=a?.dataset.model;a=a?.dataset.id;if(!d||!a){var g=window.location.pathname.split("/").filter(Boolean);const h=g.indexOf("instances"),e=g.indexOf("networks");-1!==h&&g[h+1]?(d="instance",a=g[h+1]):-1!==e&&g[e+1]&&(d="network",a=g[e+1])}g="network"===d?a:null;d="instance"===d?a:null;return g?React.createElement("div",{className:"octavia-plugin"},React.createElement(NetworkView,{networkId:g})):
d?React.createElement("div",{className:"octavia-plugin"},React.createElement(InstanceView,{instanceId:d})):React.createElement("div",{className:"alert alert-warning octavia-plugin"},"Context missing.")};ReactDOM.createRoot?ReactDOM.createRoot(mountNode).render(React.createElement(App,null)):ReactDOM.render(React.createElement(App,null),mountNode);