//# sourceMappingURL=octavia-loadbalancer-ui.js.map
window.Octavia=window.Octavia||{};window.Octavia.Badge=({text:a,tone:c="info"})=>React.createElement("span",{className:`label label-${c}`,style:{marginRight:6,borderRadius:3,padding:"3px 8px",fontSize:"0.8em"}},a);
window.Octavia.Field=({label:a,children:c,help:f,required:k})=>React.createElement("div",{className:"form-group"},React.createElement("label",{className:"control-label"},a,k?React.createElement("span",{className:"text-danger"}," *"):null),c,f?React.createElement("div",{className:"help-block"},f):null);
window.Octavia.Toast=({msg:a,type:c,onClose:f})=>{React.useEffect(()=>{const k=setTimeout(f,3E3);return()=>clearTimeout(k)},[f]);return React.createElement("div",{style:{position:"fixed",top:20,right:20,zIndex:9999,backgroundColor:"error"===c?"#f2dede":"#dff0d8",color:"error"===c?"#a94442":"#3c763d",padding:"10px 20px",borderRadius:4,boxShadow:"0 2px 10px rgba(0,0,0,0.2)",display:"flex",alignItems:"center"}},React.createElement("span",{style:{marginRight:10}},a),React.createElement("button",{onClick:f,
style:{background:"none",border:"none",fontSize:16,cursor:"pointer",color:"inherit"}},"&times;"))};window.Octavia=window.Octavia||{};
(function(){const a=()=>{const b=document.querySelector('meta[name="csrf-token"]')||document.querySelector('meta[name="_csrf"]');return b?b.getAttribute("content"):null},c=()=>{const b=document.querySelector('meta[name="_csrf_header"]');return b?b.getAttribute("content"):"X-CSRF-TOKEN"},f=b=>(b=document.cookie.match(new RegExp("(^|; )"+b.replace(/([.*+?^${}()|[\]\\])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(b[2]):null,k=(b,e={})=>{const p={Accept:"application/json","X-Requested-With":"XMLHttpRequest"};
e.body&&(p["Content-Type"]="application/json");var d=a();if(d){const g=c();p[g]=d;p["X-CSRF-TOKEN"]=d}if(d=f("XSRF-TOKEN"))p["X-XSRF-TOKEN"]=d,p["X-CSRF-TOKEN"]||(p["X-CSRF-TOKEN"]=d);e=Object.assign({credentials:"include",headers:p},e);console.log(`[Octavia] Fetching: ${b}`,e);return fetch(b,e).then(async g=>{var h=await g.text();if(h)try{var q=JSON.parse(h)}catch(r){q={raw:h}}else q={};h=q;if(!g.ok)throw Error(h?.message||h?.error||`Request failed (${g.status})`);return h})};window.Octavia.makeApi=
b=>{const e=`/plugin/${b}`,p=(d,g)=>{const h=[];g&&g.networkId&&h.push("networkId="+g.networkId);g&&g.instanceId&&h.push("instanceId="+g.instanceId);return 0===h.length?d:d+(d.includes("?")?"&":"?")+h.join("&")};return{listLoadBalancers:d=>k(p(`${e}/loadbalancers`,d)),getLoadBalancer:(d,g)=>k(p(`${e}/loadbalancers/details?id=${d}`,g)),createLoadBalancer:d=>k(`${e}/loadbalancers/create`,{method:"POST",body:JSON.stringify(d)}),updateLoadBalancer:(d,g)=>k(`${e}/loadbalancers/update`,{method:"POST",body:JSON.stringify({...g,
id:d})}),deleteLoadBalancer:(d,g)=>k(`${e}/loadbalancers/delete`,{method:"POST",body:JSON.stringify({lbId:d,networkId:g})}),listOptions:(d,g)=>{const h={networkId:d,instanceId:g};return Promise.all(["projects","subnets","instances","floatingIpPools"].map(q=>k(p(`${e}/options/${q}`,h)))).then(q=>q.reduce((r,u)=>({...r,...u}),{}))},listListeners:(d,g)=>k(p(`${e}/loadbalancers/details?id=${d}`,g)).then(h=>({listeners:h.loadbalancer?.listeners||[]})),listPools:(d,g)=>k(p(`${e}/loadbalancers/details?id=${d}`,
g)).then(h=>({pools:h.loadbalancer?.pools||[]})),getHealthMonitor:(d,g)=>k(p(`${e}/loadbalancers/details?id=${d}`,g)).then(h=>{h=(h.loadbalancer?.pools||[]).find(q=>q.healthmonitor_id)?.healthmonitor_id;return{monitor:h?{id:h}:null}}),attachFloatingIp:(d,g,h)=>k(`${e}/floatingip/attach`,{method:"POST",body:JSON.stringify({lbId:d,floatingIpPoolId,networkId:h})}),detachFloatingIp:(d,g)=>k(`${e}/floatingip/detach`,{method:"POST",body:JSON.stringify({lbId:d,networkId:g})})}};window.Octavia.useAsync=(b,
e)=>{const [p,d]=React.useState({loading:!0});React.useEffect(()=>{let g=!0;d({loading:!0});b().then(h=>g&&d({loading:!1,data:h})).catch(h=>g&&d({loading:!1,error:h}));return()=>{g=!1}},e);return p}})();
(function(){window.Octavia=window.Octavia||{};window.Octavia.Steps={Step1_Details:({data:a,update:c,options:f})=>{const {Field:k}=window.Octavia;return React.createElement("div",{className:"form-horizontal"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(k,{label:"Name",required:!0},React.createElement("input",{className:"form-control",value:a.name||"",onChange:b=>c("name",b.target.value),placeholder:"My Load Balancer"}))),React.createElement("div",
{className:"col-md-6"},React.createElement(k,{label:"Description"},React.createElement("input",{className:"form-control",value:a.description||"",onChange:b=>c("description",b.target.value),placeholder:"Optional description"})))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(k,{label:"VIP Subnet",required:!0},React.createElement("select",{className:"form-control",value:a.vipSubnetId||"",onChange:b=>c("vipSubnetId",b.target.value)},
React.createElement("option",{value:!0},"Select Subnet..."),(f.subnets||[]).map(b=>React.createElement("option",{key:b.value,value:b.value},b.name,b.cidr?`(${b.cidr})`:""))))),React.createElement("div",{className:"col-md-6"},React.createElement(k,{label:"IP Address"},React.createElement("input",{className:"form-control",value:a.vipAddress||"",onChange:b=>c("vipAddress",b.target.value),placeholder:"Auto-assign"})))))},Step2_Listener:({data:a,update:c})=>{const {Field:f}=window.Octavia,k="HTTP HTTPS TERMINATED_HTTPS TCP UDP SCTP".split(" "),
b=["HTTP","TERMINATED_HTTPS"].includes(a.listenerProtocol),e="TERMINATED_HTTPS"===a.listenerProtocol,p=["UDP","SCTP"].includes(a.listenerProtocol);return React.createElement("div",{className:"form-horizontal"},React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.createListener,onChange:d=>c("createListener",d.target.checked)}),
React.createElement("strong",null,"Create Listener"))))),a.createListener&&React.createElement("div",{style:{borderLeft:"3px solid #ddd",paddingLeft:15,marginLeft:5}},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Listener Name",required:!0},React.createElement("input",{className:"form-control",value:a.listenerName||"",onChange:d=>c("listenerName",d.target.value)}))),React.createElement("div",{className:"col-md-3"},React.createElement(f,
{label:"Protocol",required:!0},React.createElement("select",{className:"form-control",value:a.listenerProtocol||"HTTP",onChange:d=>c("listenerProtocol",d.target.value)},k.map(d=>React.createElement("option",{key:d,value:d},d))))),React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"Port",required:!0},React.createElement("input",{type:"number",className:"form-control",value:a.listenerPort||80,onChange:d=>c("listenerPort",parseInt(d.target.value)),min:"1",max:"65535"})))),
React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Connection Limit"},React.createElement("input",{type:"number",className:"form-control",value:a.connectionLimit||-1,onChange:d=>c("connectionLimit",parseInt(d.target.value)),placeholder:"-1 for infinite"}))),React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Allowed CIDRs"},React.createElement("input",{className:"form-control",value:a.allowedCidrs||
"",onChange:d=>c("allowedCidrs",d.target.value),placeholder:"e.g. 192.168.1.0/24, 10.0.0.0/8"})))),!p&&React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"Client Data Timeout"},React.createElement("input",{type:"number",className:"form-control",value:a.clientDataTimeout||5E4,onChange:d=>c("clientDataTimeout",parseInt(d.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"TCP Inspect Timeout"},
React.createElement("input",{type:"number",className:"form-control",value:a.tcpInspectTimeout||0,onChange:d=>c("tcpInspectTimeout",parseInt(d.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"Member Connect Timeout"},React.createElement("input",{type:"number",className:"form-control",value:a.memberConnectTimeout||5E3,onChange:d=>c("memberConnectTimeout",parseInt(d.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(f,
{label:"Member Data Timeout"},React.createElement("input",{type:"number",className:"form-control",value:a.memberDataTimeout||5E4,onChange:d=>c("memberDataTimeout",parseInt(d.target.value))})))),b&&React.createElement("div",{className:"well ml-3"},React.createElement("label",null,"Insert Headers"),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.insertXForwardedFor||!1,onChange:d=>c("insertXForwardedFor",d.target.checked)}),
" X-Forwarded-For")),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.insertXForwardedPort||!1,onChange:d=>c("insertXForwardedPort",d.target.checked)})," X-Forwarded-Port")),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.insertXForwardedProto||!1,onChange:d=>c("insertXForwardedProto",d.target.checked)})," X-Forwarded-Proto"))),
e&&React.createElement("div",{className:"well ml-3"},React.createElement("label",null,"TLS Configuration"),React.createElement(f,{label:"TLS Cipher String"},React.createElement("input",{className:"form-control",value:a.tlsCipherString||"",onChange:d=>c("tlsCipherString",d.target.value),placeholder:"Default"})))))},Step3_Pool:({data:a,update:c})=>{const {Field:f}=window.Octavia,k=["ROUND_ROBIN","LEAST_CONNECTIONS","SOURCE_IP"],b=["HTTP","HTTPS","TCP","UDP","SCTP"];return React.createElement("div",
{className:"form-horizontal"},React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.createPool,onChange:e=>c("createPool",e.target.checked)}),React.createElement("strong",null,"Create Pool"))))),a.createPool&&React.createElement("div",{style:{borderLeft:"3px solid #ddd",paddingLeft:15,marginLeft:5}},React.createElement("div",
{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Pool Name",required:!0},React.createElement("input",{className:"form-control",value:a.poolName||"",onChange:e=>c("poolName",e.target.value)}))),React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Algorithm",required:!0},React.createElement("select",{className:"form-control",value:a.poolAlgorithm||"ROUND_ROBIN",onChange:e=>c("poolAlgorithm",e.target.value)},k.map(e=>React.createElement("option",
{key:e,value:e},e)))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Protocol",required:!0},React.createElement("select",{className:"form-control",value:a.poolProtocol||a.listenerProtocol||"HTTP",onChange:e=>c("poolProtocol",e.target.value)},b.map(e=>React.createElement("option",{key:e,value:e},e))))),React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Description"},React.createElement("input",
{className:"form-control",value:a.poolDesc||"",onChange:e=>c("poolDesc",e.target.value)})))),React.createElement("div",{className:"well"},React.createElement("label",null,"Session Persistence"),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Type"},React.createElement("select",{className:"form-control",value:a.sessionPersistence||"None",onChange:e=>c("sessionPersistence",e.target.value)},React.createElement("option",{value:"None"},
"None"),React.createElement("option",{value:"SOURCE_IP"},"Source IP"),React.createElement("option",{value:"HTTP_COOKIE"},"HTTP Cookie"),React.createElement("option",{value:"APP_COOKIE"},"App Cookie")))),"APP_COOKIE"===a.sessionPersistence&&React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Cookie Name",required:!0},React.createElement("input",{className:"form-control",value:a.cookieName||"",onChange:e=>c("cookieName",e.target.value)}))))),React.createElement("div",{className:"well"},
React.createElement("label",null,"TLS Encryption (Backend Re-encryption)"),React.createElement("div",{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:a.poolTlsEnabled||!1,onChange:e=>c("poolTlsEnabled",e.target.checked)}),"Enable TLS")),a.poolTlsEnabled&&React.createElement(f,{label:"Cipher String"},React.createElement("input",{className:"form-control",value:a.poolTlsCipher||"",onChange:e=>c("poolTlsCipher",e.target.value),placeholder:"Default"})))))},
Step4_Members:({data:a,update:c,options:f})=>{const {Badge:k}=window.Octavia,[b,e]=React.useState(""),p=(f.instances||[]).filter(l=>!(a.members||[]).find(w=>w.id===l.value)),[d,g]=React.useState(""),[h,q]=React.useState(80),[r,u]=React.useState(1),t=()=>{if(b){var l=f.instances.find(w=>w.value===b);l={id:l.value,name:l.name,type:"INTERNAL",address:"10.0.0."+Math.floor(255*Math.random()),port:80,weight:1,role:"member"};c("members",[...(a.members||[]),l]);e("")}},v=()=>{if(d){var l={id:"ext-"+Math.floor(1E4*
Math.random()),name:d,type:"EXTERNAL",address:d,port:h,weight:r,role:"member"};c("members",[...(a.members||[]),l]);g("")}},y=l=>{c("members",(a.members||[]).filter(w=>w.id!==l))};return React.createElement("div",null,a.createPool?React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},"Add Instance Member"),React.createElement("div",
{className:"panel-body"},React.createElement("div",{className:"input-group"},React.createElement("select",{className:"form-control",value:b,onChange:l=>e(l.target.value)},React.createElement("option",{value:!0},"Select Instance..."),p.map(l=>React.createElement("option",{key:l.value,value:l.value},l.name))),React.createElement("span",{className:"input-group-btn"},React.createElement("button",{className:"btn btn-success",onClick:t,disabled:!b},"Add")))))),React.createElement("div",{className:"col-md-6"},
React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},"Add External Member"),React.createElement("div",{className:"panel-body"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-5"},React.createElement("input",{className:"form-control input-sm",placeholder:"IP Address",value:d,onChange:l=>g(l.target.value)})),React.createElement("div",{className:"col-xs-3"},React.createElement("input",{type:"number",
className:"form-control input-sm",placeholder:"Port",value:h,onChange:l=>q(parseInt(l.target.value))})),React.createElement("div",{className:"col-xs-2"},React.createElement("input",{type:"number",className:"form-control input-sm",placeholder:"Wgt",value:r,onChange:l=>u(parseInt(l.target.value))})),React.createElement("div",{className:"col-xs-2"},React.createElement("button",{className:"btn btn-success btn-sm btn-block",onClick:v,disabled:!d},"Add"))))))),React.createElement("table",{className:"table table-striped table-bordered"},
React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Name"),React.createElement("th",null,"Address"),React.createElement("th",null,"Port"),React.createElement("th",null,"Weight"),React.createElement("th",null,"Type"),React.createElement("th",null))),React.createElement("tbody",null,0===(a.members||[]).length?React.createElement("tr",null,React.createElement("td",{colSpan:"6",className:"text-center text-muted"},"No members defined")):(a.members||[]).map(l=>
React.createElement("tr",{key:l.id},React.createElement("td",null,l.name),React.createElement("td",null,l.address),React.createElement("td",null,l.port),React.createElement("td",null,l.weight),React.createElement("td",null,React.createElement(k,{text:l.type||"INTERNAL",tone:"EXTERNAL"===l.type?"warning":"info"})),React.createElement("td",{className:"text-right"},React.createElement("button",{className:"btn btn-xs",style:{backgroundColor:"#b00020",color:"#fff",border:"none",fontWeight:600},onClick:()=>
y(l.id)},"&times;"))))))):React.createElement("div",{className:"alert alert-warning"},"Pool creation is disabled. No members can be added."))},Step5_Monitor:({data:a,update:c})=>{const {Field:f}=window.Octavia,k="HTTP HTTPS PING TCP TLS-HELLO UDP-CONNECT SCTP".split(" ");return React.createElement("div",{className:"form-horizontal"},React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",{className:"checkbox"},React.createElement("label",
null,React.createElement("input",{type:"checkbox",checked:a.createMonitor,onChange:b=>c("createMonitor",b.target.checked)}),React.createElement("strong",null,"Create Health Monitor"))))),a.createMonitor&&React.createElement("div",{style:{borderLeft:"3px solid #ddd",paddingLeft:15,marginLeft:5}},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Name",required:!0},React.createElement("input",{className:"form-control",value:a.monitorName||
"",onChange:b=>c("monitorName",b.target.value)}))),React.createElement("div",{className:"col-md-6"},React.createElement(f,{label:"Type",required:!0},React.createElement("select",{className:"form-control",value:a.monitorType||"HTTP",onChange:b=>c("monitorType",b.target.value)},k.map(b=>React.createElement("option",{key:b,value:b},b)))))),("HTTP"===a.monitorType||"HTTPS"===a.monitorType)&&React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-4"},
React.createElement(f,{label:"HTTP Method"},React.createElement("select",{className:"form-control",value:a.httpMethod||"GET",onChange:b=>c("httpMethod",b.target.value)},"GET HEAD POST PUT DELETE TRACE OPTIONS PATCH CONNECT".split(" ").map(b=>React.createElement("option",{key:b,value:b},b))))),React.createElement("div",{className:"col-md-4"},React.createElement(f,{label:"Expected Codes"},React.createElement("input",{className:"form-control",value:a.expectedCodes||"200",onChange:b=>c("expectedCodes",
b.target.value),placeholder:"200, 200-204"}))),React.createElement("div",{className:"col-md-4"},React.createElement(f,{label:"URL Path"},React.createElement("input",{className:"form-control",value:a.urlPath||"/",onChange:b=>c("urlPath",b.target.value),placeholder:"/"}))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"Delay (sec)",required:!0},React.createElement("input",{type:"number",className:"form-control",value:a.delay||
5,onChange:b=>c("delay",parseInt(b.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"Timeout (sec)",required:!0},React.createElement("input",{type:"number",className:"form-control",value:a.timeout||5,onChange:b=>c("timeout",parseInt(b.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"Max Retries",required:!0},React.createElement("input",{type:"number",className:"form-control",value:a.maxRetries||3,onChange:b=>
c("maxRetries",parseInt(b.target.value))}))),React.createElement("div",{className:"col-md-3"},React.createElement(f,{label:"Max Retries Down"},React.createElement("input",{type:"number",className:"form-control",value:a.maxRetriesDown||3,onChange:b=>c("maxRetriesDown",parseInt(b.target.value))}))))))}}})();
const DeleteConfirmModal=({lb:a,onClose:c,onConfirm:f,loading:k})=>React.createElement("div",{className:"modal fade in",style:{display:"block"}},React.createElement("div",{className:"modal-dialog"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("button",{type:"button",className:"close",onClick:c},React.createElement("img",{src:"/assets/octavia1234/images/times.svg",style:{width:12,height:12},alt:"Close"})),React.createElement("h4",
{className:"modal-title"},"Delete Load Balancer")),React.createElement("div",{className:"modal-body"},React.createElement("p",null,"Are you sure you want to delete",React.createElement("strong",null,a.name),"?"),React.createElement("p",{className:"text-muted"},React.createElement("small",null,"This action cannot be undone.")),k&&React.createElement("div",{className:"text-center"},React.createElement("i",{className:"fa fa-spinner fa-spin"})," Deleting...")),React.createElement("div",{className:"modal-footer"},
React.createElement("button",{className:"btn btn-link",onClick:c,disabled:k},"Cancel"),React.createElement("button",{className:"btn btn-danger",onClick:f,disabled:k},"Delete")))),React.createElement("div",{className:"modal-backdrop fade in"}));window.Octavia=window.Octavia||{};window.Octavia.DeleteConfirmModal=DeleteConfirmModal;
(function(){window.Octavia.CreateWizard=({networkId:a,options:c,onClose:f})=>{const {Step1_Details:k,Step2_Listener:b,Step3_Pool:e,Step4_Members:p,Step5_Monitor:d}=window.Octavia.Steps,[g,h]=React.useState(1);React.useState("");const [q,r]=React.useState({networkId:a,createListener:!0,createPool:!0,createMonitor:!0,listenerProtocol:"HTTP",listenerPort:80,poolProtocol:"HTTP",poolAlgorithm:"ROUND_ROBIN",monitorType:"HTTP",members:[]}),[u,t]=React.useState(!1),v=(y,l)=>r(w=>({...w,[y]:l}));React.useEffect(()=>
{c&&c.subnets&&0<c.subnets.length&&!q.vipSubnetId&&v("vipSubnetId",c.subnets[0].value)},[c]);a=()=>{t(!0);window.Octavia.api.createLoadBalancer(q).then(()=>{window.location.reload()}).catch(y=>{t(!1);alert("Error: "+y.message)})};return React.createElement("div",{className:"modal fade in",style:{display:"block",backgroundColor:"rgba(0,0,0,0.5)"}},React.createElement("div",{className:"modal-dialog modal-lg"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},
React.createElement("button",{type:"button",className:"close",onClick:f},"&times;"),React.createElement("h4",{className:"modal-title"},"Create Load Balancer (Octavia)")),React.createElement("div",{className:"modal-body"},React.createElement("ul",{className:"nav nav-pills nav-justified",style:{marginBottom:20}},React.createElement("li",{className:1===g?"active":""},React.createElement("a",{onClick:()=>h(1)},"1. Details")),React.createElement("li",{className:2===g?"active":""},React.createElement("a",
{onClick:()=>h(2)},"2. Listener")),React.createElement("li",{className:3===g?"active":""},React.createElement("a",{onClick:()=>h(3)},"3. Pool")),React.createElement("li",{className:4===g?"active":""},React.createElement("a",{onClick:()=>h(4)},"4. Members")),React.createElement("li",{className:5===g?"active":""},React.createElement("a",{onClick:()=>h(5)},"5. Monitor"))),(()=>{switch(g){case 1:return React.createElement(k,{data:q,update:v,options:c});case 2:return React.createElement(b,{data:q,update:v});
case 3:return React.createElement(e,{data:q,update:v});case 4:return React.createElement(p,{data:q,update:v,options:c});case 5:return React.createElement(d,{data:q,update:v});default:return React.createElement("div",null,"Unknown Step")}})()),React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"btn btn-default",onClick:f},"Cancel"),1<g&&React.createElement("button",{className:"btn btn-default",onClick:()=>h(g-1)},"Previous"),5>g&&React.createElement("button",
{className:"btn btn-primary",onClick:()=>h(g+1)},"Next"),5===g&&React.createElement("button",{className:"btn btn-success",onClick:a,disabled:u},u?"Creating...":"Create Load Balancer")))))}})();
(function(){window.Octavia.EditLBModal=({lb:a,networkId:c,onClose:f,onUpdated:k})=>{const b=window.Octavia.api,{Field:e,useAsync:p}=window.Octavia,{Step2_Listener:d,Step3_Pool:g,Step4_Members:h,Step5_Monitor:q}=window.Octavia.Steps,[r,u]=React.useState("general"),[t,v]=React.useState({...a}),[y,l]=React.useState(!1),{loading:w,data:x}=p(async()=>{const [m,n,A]=await Promise.all([b.listListeners(a.id,{networkId:c}),b.listPools(a.id,{networkId:c}),b.getHealthMonitor(a.id,{networkId:c})]);return{...m,
...n,...A}},[a.id]);React.useEffect(()=>{if(x){const n={...t};if(x.listeners&&0<x.listeners.length){var m=x.listeners[0];n.createListener=!0;n.listenerName=m.name;n.listenerProtocol=m.protocol;n.listenerPort=m.protocol_port;n.connectionLimit=m.connection_limit;n.allowedCidrs=(m.allowed_cidrs||[]).join(",")}else n.createListener=!1;x.pools&&0<x.pools.length?(m=x.pools[0],n.createPool=!0,n.poolName=m.name,n.poolAlgorithm=m.lb_algorithm,n.poolProtocol=m.protocol,n.poolDesc=m.description,n.members=m.members||
[]):n.createPool=!1;x.monitor?(m=x.monitor,n.createMonitor=!0,n.monitorName=m.name||"Monitor",n.monitorType=m.type,n.delay=m.delay,n.timeout=m.timeout,n.maxRetries=m.max_retries):n.createMonitor=!1;v(n)}},[x]);const z=(m,n)=>v(A=>({...A,[m]:n}));return React.createElement("div",{className:"modal fade in",style:{display:"block",overflow:"auto"}},React.createElement("div",{className:"modal-dialog modal-lg"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},
React.createElement("button",{type:"button",className:"close",onClick:f},React.createElement("img",{src:"/assets/octavia1234/images/times.svg",style:{width:14,height:14},alt:"Close"})),React.createElement("h4",{className:"modal-title"},"Edit Load Balancer")),React.createElement("div",{className:"modal-body",style:{padding:0}},React.createElement("div",{className:"tab-container"},React.createElement("ul",{className:"nav nav-tabs",style:{paddingLeft:20,paddingTop:10}},[{key:"general",title:"General"},
{key:"listener",title:"Listener"},{key:"pool",title:"Pool"},{key:"monitor",title:"Health Monitor"}].map((m,n)=>React.createElement("li",{key:m.key,className:r===m.key?"active":""},React.createElement("a",{href:"#",onClick:A=>{A.preventDefault();u(m.key)}},m.title)))),React.createElement("div",{className:"tab-content",style:{padding:20}},w?React.createElement("div",{style:{textAlign:"center",padding:40}},React.createElement("i",{className:"fa fa-spinner fa-spin"})," Loading..."):React.createElement("div",
null,"general"===r&&React.createElement("div",{className:"form-horizontal"},React.createElement(e,{label:"Name"},React.createElement("input",{className:"form-control",value:t.name||"",onChange:m=>z("name",m.target.value)})),React.createElement(e,{label:"Description"},React.createElement("input",{className:"form-control",value:t.description||"",onChange:m=>z("description",m.target.value)})),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",
{className:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:t.admin_state_up,onChange:m=>z("admin_state_up",m.target.checked)})," Admin State Up"))))),"listener"===r&&React.createElement(d,{data:t,update:z}),"pool"===r&&React.createElement("div",null,React.createElement(g,{data:t,update:z}),React.createElement("hr",null),React.createElement("h5",{style:{fontWeight:600,marginBottom:15}},"Members"),React.createElement(h,{data:t,update:z,options:{instances:[]}})),
"monitor"===r&&React.createElement(q,{data:t,update:z}))))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"btn btn-link",onClick:f},"Cancel"),React.createElement("button",{className:"btn btn-primary",onClick:()=>{l(!0);b.updateLoadBalancer(a.id,t).then(k).catch(m=>{l(!1);alert(m.message)})},disabled:y||w},y?"Saving...":"Save Changes")))),React.createElement("div",{className:"modal-backdrop fade in"}))}})();
(function(){window.Octavia.NetworkView=({networkId:a})=>{const c=window.Octavia.api,{Badge:f,useAsync:k,Toast:b}=window.Octavia,[e,p]=React.useState("list"),[d,g]=React.useState(null),[h,q]=React.useState(null);var r=k(()=>c.listOptions(a),[a]),u=k(()=>c.listLoadBalancers({networkId:a}),[a,h]);const [t,v]=React.useState(null),[y,l]=React.useState(!1);if(u.error)return React.createElement("div",{className:"alert alert-danger"},u.error.message);if(u.loading||r.loading)return React.createElement("div",
{style:{padding:20}},React.createElement("i",{className:"fa fa-spinner fa-spin"})," Loading...");u=u.data.loadbalancers||[];r=r.data||{};const w=()=>{l(!0);c.deleteLoadBalancer(t.id,a).then(()=>{l(!1);v(null);q({msg:"Load Balancer deleted successfully.",type:"success"})})},x=window.Octavia.CreateWizard,z=window.Octavia.EditLBModal,m=window.Octavia.DeleteConfirmModal;return React.createElement("div",{style:{padding:"0"}},h&&React.createElement(b,{msg:h.msg,type:h.type,onClose:()=>q(null)}),t&&React.createElement(m,
{lb:t,loading:y,onClose:()=>v(null),onConfirm:w}),"create"===e&&React.createElement(x,{networkId:a,options:r,onClose:()=>p("list"),onCreated:()=>{p("list");q({msg:"Load Balancer created.",type:"success"})}}),"edit"===e&&d&&React.createElement(z,{lb:d,networkId:a,onClose:()=>{g(null);p("list")},onUpdated:()=>{g(null);p("list");q({msg:"Load Balancer updated.",type:"success"})}}),React.createElement("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginBottom:15,padding:"0 5px"}},
React.createElement("button",{className:"btn",style:{backgroundColor:"#f9c600",color:"#000",border:"none",fontWeight:600,textTransform:"uppercase",padding:"6px 14px",fontSize:"0.85em"},onClick:()=>p("create")},React.createElement("i",{className:"fa fa-plus",style:{marginRight:5}})," Add")),React.createElement("table",{className:"table",style:{borderCollapse:"collapse"}},React.createElement("thead",null,React.createElement("tr",{style:{borderBottom:"2px solid #e1e3e5"}},React.createElement("th",{style:{textTransform:"uppercase",
fontSize:"0.8em",fontWeight:600,color:"#555",letterSpacing:"0.5px",padding:"10px 12px"}},"Name"),React.createElement("th",{style:{textTransform:"uppercase",fontSize:"0.8em",fontWeight:600,color:"#555",letterSpacing:"0.5px",padding:"10px 12px"}},"VIP"),React.createElement("th",{style:{textTransform:"uppercase",fontSize:"0.8em",fontWeight:600,color:"#555",letterSpacing:"0.5px",padding:"10px 12px"}},"Status"),React.createElement("th",{style:{textTransform:"uppercase",fontSize:"0.8em",fontWeight:600,
color:"#555",letterSpacing:"0.5px",padding:"10px 12px"}},"Members"),React.createElement("th",{style:{textTransform:"uppercase",fontSize:"0.8em",fontWeight:600,color:"#555",letterSpacing:"0.5px",padding:"10px 12px",width:80}}))),React.createElement("tbody",null,u.map(n=>React.createElement("tr",{key:n.id,style:{borderBottom:"1px solid #eee"}},React.createElement("td",{style:{padding:"12px",verticalAlign:"middle",fontWeight:500,color:"#333"}},n.name),React.createElement("td",{style:{padding:"12px",
verticalAlign:"middle",color:"#555"}},n.vipAddress),React.createElement("td",{style:{padding:"12px",verticalAlign:"middle"}},React.createElement(f,{text:n.provisioning_status,tone:"ACTIVE"===n.provisioning_status?"success":"warning"})),React.createElement("td",{style:{padding:"12px",verticalAlign:"middle",color:"#555"}},(n.members||[]).length),React.createElement("td",{style:{padding:"12px",verticalAlign:"middle",textAlign:"right",whiteSpace:"nowrap"}},React.createElement("button",{className:"btn btn-link btn-sm",
style:{marginRight:6,padding:"3px 8px"},title:"Edit",onClick:()=>{g(n);p("edit")}},React.createElement("img",{src:"/assets/octavia1234/images/pencil.svg",style:{width:14,height:14},alt:"Edit"})),React.createElement("button",{className:"btn btn-link btn-sm",style:{padding:"3px 8px"},title:"Delete",onClick:()=>v(n)},React.createElement("img",{src:"/assets/octavia1234/images/trash.svg",style:{width:14,height:14},alt:"Delete"}))))))),0===u.length&&React.createElement("div",{style:{textAlign:"center",
padding:"30px 0",color:"#999"}},'No Load Balancers found. Click "+ Add" to create one.'))}})();
(function(){window.Octavia.InstanceView=({instanceId:a})=>{const c=window.Octavia.api,{Badge:f,useAsync:k}=window.Octavia;var b=k(()=>c.listLoadBalancers({instanceId:a}),[a]);if(b.error)return React.createElement("div",{className:"alert alert-danger"},b.error.message);if(b.loading)return React.createElement("div",{style:{padding:20,textAlign:"center"}},React.createElement("span",{style:{display:"inline-block",width:16,height:16,border:"2px solid #ccc",borderTopColor:"#333",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),
" Loading...");b=b.data?.loadbalancers||[];return 0===b.length?React.createElement("div",{className:"alert alert-info"},"This instance is not a member of any Octavia load balancer."):React.createElement("div",{className:"container-fluid",style:{padding:"0 12px"}},React.createElement("h4",{style:{textTransform:"uppercase",fontWeight:600,letterSpacing:"0.5px",color:"#2d6ca2",marginBottom:15}},"Load balancers associated with this instance"),React.createElement("p",{className:"text-muted",style:{marginBottom:15,
fontSize:"0.9em"}},"This instance is a pool member of the following load balancers. Click a name to manage it on the Network detail page."),React.createElement("div",{className:"table-responsive"},React.createElement("table",{className:"table table-striped table-hover"},React.createElement("thead",null,React.createElement("tr",{style:{textTransform:"uppercase",fontSize:"0.85em",fontWeight:600}},React.createElement("th",null,"Name"),React.createElement("th",null,"VIP"),React.createElement("th",null,
"Status"),React.createElement("th",null,"Members"),React.createElement("th",null,"Network"))),React.createElement("tbody",null,b.map(e=>React.createElement("tr",{key:e.id},React.createElement("td",null,React.createElement("a",{href:"/infrastructure/networks/"+(e.networkId||"")+"#!octavia-network-tab",style:{fontWeight:"bold",color:"#2d6ca2",textDecoration:"none"},title:"View in Network detail Octavia tab"},e.name)),React.createElement("td",null,e.vipAddress),React.createElement("td",null,React.createElement(f,
{text:e.provisioning_status||"ACTIVE",tone:"ACTIVE"===(e.provisioning_status||"ACTIVE")?"success":"warning"})),React.createElement("td",null,(e.members||[]).length),React.createElement("td",null,React.createElement("a",{href:"/infrastructure/networks/"+(e.networkId||""),style:{color:"#2d6ca2"}},e.networkName||"View Network"))))))))}})();window.Octavia=window.Octavia||{};console.log("Octavia UI Components Loaded.");
const mountNode=document.getElementById("octavia-loadbalancer-view"),pluginCode=mountNode?.dataset?.pluginCode||"octavia1234";window.Octavia.api=window.Octavia.makeApi(pluginCode);
const {NetworkView,InstanceView}=window.Octavia,App=()=>{var a=document.getElementById("octavia-loadbalancer-view"),c=a?.dataset.model;a=a?.dataset.id;if(!c||!a){var f=window.location.pathname.split("/").filter(Boolean);const k=f.indexOf("instances"),b=f.indexOf("networks");-1!==k&&f[k+1]?(c="instance",a=f[k+1]):-1!==b&&f[b+1]&&(c="network",a=f[b+1])}f="network"===c?a:null;c="instance"===c?a:null;return f?React.createElement(NetworkView,{networkId:f}):c?React.createElement(InstanceView,{instanceId:c}):
React.createElement("div",{className:"alert alert-warning"},"Context missing.")};ReactDOM.createRoot?ReactDOM.createRoot(mountNode).render(React.createElement(App,null)):ReactDOM.render(React.createElement(App,null),mountNode);